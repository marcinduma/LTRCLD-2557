
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Explore Simplicity of Public Cloud Network Configuration with Cloud Network Controller (formerly cAPIC) and Nexus Dashboard Orchestrator (NDO)" name="description"/>
<meta content="Marcin Duma &amp; Karol Okraska" name="author"/>
<link href="../assets/images/favicon.png" rel="icon"/>
<meta content="mkdocs-1.4.2, mkdocs-material-8.5.10" name="generator"/>
<title>Use-case 02 - Internet Gateway - CiscoLive EMEA 2023 --- LTRCLD-2557</title>
<link href="../assets/stylesheets/main.975780f9.min.css" rel="stylesheet"/>
<link href="../assets/stylesheets/palette.2505c338.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../css/print-site-enum-headings1.css" rel="stylesheet"/>
<link href="../css/print-site-enum-headings2.css" rel="stylesheet"/>
<link href="../css/print-site-enum-headings3.css" rel="stylesheet"/>
<link href="../css/print-site-enum-headings4.css" rel="stylesheet"/>
<link href="../css/print-site-enum-headings5.css" rel="stylesheet"/>
<link href="../css/print-site-enum-headings6.css" rel="stylesheet"/>
<link href="../css/print-site.css" rel="stylesheet"/>
<link href="../css/print-site-material.css" rel="stylesheet"/>
<script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
            html.glightbox-open { overflow: initial; height: 100%; }
            .gslide-title { margin-top: 0px; user-select: text; }
            .gslide-desc { color: #666; user-select: text; }
            .gslide-image img { background: white; }
            
                .gscrollbar-fixer { padding-right: 15px; }
                .gdesc-inner { font-size: 0.75rem; }
                body[data-md-color-scheme="slate"] .gdesc-inner { background: var(--md-default-bg-color);}
                body[data-md-color-scheme="slate"] .gslide-title { color: var(--md-default-fg-color);}
                body[data-md-color-scheme="slate"] .gslide-desc { color: var(--md-default-fg-color);}
                </style><script src="../assets/javascripts/glightbox.min.js"></script></head>
<body data-md-color-accent="None" data-md-color-primary="None" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#use-case-02-internet-gateway">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="CiscoLive EMEA 2023 --- LTRCLD-2557" class="md-header__button md-logo" data-md-component="logo" href=".." title="CiscoLive EMEA 2023 --- LTRCLD-2557">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            CiscoLive EMEA 2023 --- LTRCLD-2557
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Use-case 02 - Internet Gateway
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="CiscoLive EMEA 2023 --- LTRCLD-2557" class="md-nav__button md-logo" data-md-component="logo" href=".." title="CiscoLive EMEA 2023 --- LTRCLD-2557">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"></path></svg>
</a>
    CiscoLive EMEA 2023 --- LTRCLD-2557
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
          Lab access
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Lab access" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
          Lab access
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../LAB_access/">
        Accessing the Lab Environment
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2">
          Lab details
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Lab details" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
          Lab details
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../pod1/">
        POD-01
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod2.md">
        POD-02
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod3.md">
        POD-03
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod4.md">
        POD-04
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod5.md">
        POD-05
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod6.md">
        POD-06
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod7.md">
        POD-07
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod8.md">
        POD-08
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod9.md">
        POD-09
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../pod10.md">
        POD-10
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" id="__nav_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_3">
          Infrastructure configuration
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Infrastructure configuration" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_3">
<span class="md-nav__icon md-icon"></span>
          Infrastructure configuration
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../infra-config/">
        Sites onboarding
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../infra-config-msite/">
        Multisite configuration
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" id="__nav_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_4">
          Tenant configuration
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Tenant configuration" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_4">
<span class="md-nav__icon md-icon"></span>
          Tenant configuration
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../ndo-tenant/">
        NDO Tenant Configuration
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../aws-trust/">
        AWS Trust
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" id="__nav_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_5">
          Use-cases
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Use-cases" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_5">
<span class="md-nav__icon md-icon"></span>
          Use-cases
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../use-case1/">
        Use-case 01 - Stretched VRF
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
          Use-case 02 - Internet Gateway
          <span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Use-case 02 - Internet Gateway
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#internet-gateway-as-external-epg">
    Internet Gateway as External EPG
  </a>
<nav aria-label="Internet Gateway as External EPG" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#external-epg-configuration">
    External EPG configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#contract-configuration">
    Contract configuration
  </a>
<nav aria-label="Contract configuration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-filter-creation">
    1. Filter creation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-contract-configuration">
    2. Contract configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-contract-assigment-to-epgs">
    3. Contract assigment to EPGs
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#veryfication">
    Veryfication
  </a>
<nav aria-label="Veryfication" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-open-aws-console-via-browser">
    1. Open AWS console via browser
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-select-iam-user-provide-account-id-for-user-tenant-and-hit-next">
    2. Select IAM user,  provide Account ID for User tenant and hit "Next"
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-provide-username-and-password-and-hit-sign-in">
    3. Provide Username and password and hit "Sign In"
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-in-aws-search-bar-type-ec2-and-select-ec2-services-tab">
    4. In AWS Search Bar type "EC2" and Select "EC2" Services Tab
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-from-resources-select-instances-running">
    5. From "Resources" select "Instances (Running)"
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../use-case3/">
        Use-case 03 - Inter-Tenant routing
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" id="__nav_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_6">
          Appendixes
          <span class="md-nav__icon md-icon"></span>
</label>
<nav aria-label="Appendixes" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
          Appendixes
        </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../object-map/">
        ACI to Public Cloud Object mapping
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../resources/">
        Resources
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../print_page/">
        PRINT version
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#internet-gateway-as-external-epg">
    Internet Gateway as External EPG
  </a>
<nav aria-label="Internet Gateway as External EPG" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#external-epg-configuration">
    External EPG configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#contract-configuration">
    Contract configuration
  </a>
<nav aria-label="Contract configuration" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-filter-creation">
    1. Filter creation
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-contract-configuration">
    2. Contract configuration
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-contract-assigment-to-epgs">
    3. Contract assigment to EPGs
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#veryfication">
    Veryfication
  </a>
<nav aria-label="Veryfication" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-open-aws-console-via-browser">
    1. Open AWS console via browser
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-select-iam-user-provide-account-id-for-user-tenant-and-hit-next">
    2. Select IAM user,  provide Account ID for User tenant and hit "Next"
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-provide-username-and-password-and-hit-sign-in">
    3. Provide Username and password and hit "Sign In"
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-in-aws-search-bar-type-ec2-and-select-ec2-services-tab">
    4. In AWS Search Bar type "EC2" and Select "EC2" Services Tab
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-from-resources-select-instances-running">
    5. From "Resources" select "Instances (Running)"
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="use-case-02-internet-gateway">Use-case 02 - Internet Gateway</h1>
<p><strong>In this task we will configure Internet Gateway in AWS cloud, so EC2 instances and Endpoints are able to reach Internet.</strong></p>
<p>Instances in AWS can access Internet with help of Internet Gateway. An internet gateway is a horizontally scaled, redundant, and highly available VPC component that allows communication between VPC and the internet.</p>
<p>An internet gateway provides a target VPC route tables for internet-routable traffic. For communication using IPv4, the internet gateway also performs network address translation (NAT).</p>
<h2 id="internet-gateway-as-external-epg">Internet Gateway as External EPG</h2>
<p>As all routing aspectes of VPC are controlled by Cloud Network Controller, also Internet Gateway(IGW) is configured with it's help. Internet Gateway is represented by well know ACI object - External EPG. Cloud Network Controller is fully automating creation and attachemnt of IGW to VPC, contracts are responsible for security rules, so administrators are in full controll of traffic flow. </p>
<h3 id="external-epg-configuration">External EPG configuration</h3>
<p>Open Nexus Dashboard Orchestrator GUI and navigate to <strong>Application Management -&gt; Schemas -&gt; "Schema-T01"</strong> -&gt; open </p>
<p>Under View select <strong>"temp-AWS-01"</strong> and hit <strong>"Add External EPGs"</strong> under <strong>External EPGs</strong> section. </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image172.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image172.png" width="800"/></a></p>
<ul>
<li>Display Name: <strong>ExtEPG-IGW</strong></li>
<li>Description: <strong>Ext EPG for Internet Gateway AWS</strong> </li>
<li>Virutal Routing &amp; Forwarding: <strong>VRF-01</strong> </li>
<li>Select Site Type: <strong>CLOUD</strong> </li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image174.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image174.png" width="800"/></a> </p>
<ul>
<li>
<p>Cloud Properties: </p>
<ul>
<li>Application Profile: <strong>AppProf-AWS-01</strong></li>
<li>
<p>Add Selector: </p>
<ul>
<li>Endpoint Selector Name: <strong>Internet</strong></li>
<li>Expression Type: <strong>IP Address</strong></li>
<li>Expression Operator: <strong>Equal</strong></li>
<li>Expression Value: <strong>0.0.0.0/0</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image173.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image173.png" width="800"/></a> </p>
<p>Hit <strong>Save</strong> to finish. </p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Adding the "0.0.0.0/0" subnet will add additional route to this prefix, pointing to internet gateway object create in AWS. In case only specyfic prefixes should be rechable, you can use differnt subnet that 0.0.0.0/0. </p>
</div>
<h3 id="contract-configuration">Contract configuration</h3>
<p>As External EPG is functioning as any other EPG, contract configuration from EPG to External EPG is mandatory for traffic to be allowed. </p>
<h4 id="1-filter-creation">1. Filter creation</h4>
<p>Open Nexus Dashboard Orchestrator GUI then go to <strong>Application Management -&gt; Schemas -&gt; "Schema-T01"</strong> -&gt; open </p>
<p>Under View select <strong>"temp-AWS-01""</strong> and <strong>"Add filter"</strong> under <strong>Filter</strong> section. </p>
<ul>
<li>Display Name: <strong>permit-any-aws</strong> </li>
</ul>
<p>Then click <strong>"Add entry"</strong> to define protocols and ports. </p>
<ul>
<li>Name: <strong>permit-any</strong> </li>
</ul>
<p>Leave rest setting as default - this will allow for all protocols and ports. </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image144.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image144.png" width="600"/></a></p>
<p>Hit <strong>Ok</strong> to save it. </p>
<h4 id="2-contract-configuration">2. Contract configuration</h4>
<p>As contracts will be used to connect AWS EPG to ExtEPG of AWS, contract should be created in AWS template </p>
<p>Under View select <strong>"temp-AWS-01"</strong> and <strong>"Add contract"</strong> under <strong>Contract</strong> section. </p>
<p>Create two(2) contracts with following details: </p>
<ul>
<li>
<p>Contract <strong>con-AWS-01-to-IGW</strong> </p>
<ul>
<li>Display Name: <strong>con-AWS-01-to-IGW</strong> </li>
<li>Scope: <strong>VRF</strong></li>
<li>Apply both direction: <strong>yes</strong></li>
<li>Add Filter: <strong>permit-any-AWS</strong></li>
</ul>
</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image176.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image176.png" width="800"/></a></p>
<p>Hit <strong>Save</strong> to finish contract configuration. </p>
<ul>
<li>
<p>Contract <strong>con-IGW-to-AWS-01</strong> </p>
<ul>
<li>Display Name: <strong>con-IGW-to-AWS-01</strong> </li>
<li>Scope: <strong>VRF</strong></li>
<li>Apply both direction: <strong>yes</strong></li>
<li>Add Filter: <strong>permit-any-AWS</strong></li>
</ul>
</li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image175.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image175.png" width="800"/></a></p>
<p>Hit <strong>Save</strong> to finish contract configuration. </p>
<p>Hit <strong>Deploy to sites</strong> for contracts to be pushed. </p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Having contract only in one direction where Internet Gateway is a provider will be enough for EC2 instances to reach Internet, however contract in opposite direction is needed in case you want to connect to EC2 instances Public IPv4 Addresses from Internet. </p>
</div>
<h4 id="3-contract-assigment-to-epgs">3. Contract assigment to EPGs</h4>
<p>Under View select <strong>"temp-AWS-01"</strong> click on the <strong>EPG-AWS-01</strong> and under EPG specific setting locate <strong>Contract</strong> section</p>
<p>Hit <strong>"Add Contract"</strong> button and add the following</p>
<p>Contract 1: </p>
<ul>
<li>EPG: <strong>EPG-AWS01</strong></li>
<li>Contract: <strong>con-AWS-01-to-IGW</strong>*</li>
<li>Type: <strong>provider</strong> </li>
</ul>
<p>Contract 2: </p>
<ul>
<li>EPG: <strong>EPG-AWS-01</strong></li>
<li>Contract: <strong>con-IGW-to-AWS-01</strong></li>
<li>Type: <strong>consumer</strong> </li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image177.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image177.png" width="800"/></a></p>
<p>Under View select <strong>"temp-AWS-01"</strong> click on the <strong>ExtEPG-IGW</strong> and under <strong>Common Properties</strong> locate <strong>Contract</strong> section</p>
<p>Hit <strong>"Add Contract"</strong> button and add the following</p>
<p>Contract 1: </p>
<ul>
<li>EPG: <strong>ExtEPG-IGW</strong></li>
<li>Contract: <strong>con-IGW-to-AWS-01</strong></li>
<li>Type: <strong>provider</strong> </li>
</ul>
<p>Contract 2: </p>
<ul>
<li>EPG: <strong>ExtEPG-IGW</strong></li>
<li>Contract: <strong>con-AWS-01-to-IGW</strong></li>
<li>Type: <strong>consumer</strong> </li>
</ul>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image178.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image178.png" width="800"/></a></p>
<p>Hit <strong>Deploy to sites</strong> to create IGW and deploy contracts associations. </p>
<h2 id="veryfication">Veryfication</h2>
<p>Let's check if AWS EC2 instance is now reachable from the internet. </p>
<h3 id="1-open-aws-console-via-browser">1. Open AWS console via browser</h3>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image3.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image3.png" width="400"/></a></p>
<h3 id="2-select-iam-user-provide-account-id-for-user-tenant-and-hit-next">2. Select IAM user,  provide Account ID for User tenant and hit "Next"</h3>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image4.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image4.png" width="300"/></a></p>
<h3 id="3-provide-username-and-password-and-hit-sign-in">3. Provide Username and password and hit "Sign In"</h3>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image5.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image5.png" width="300"/></a></p>
<h3 id="4-in-aws-search-bar-type-ec2-and-select-ec2-services-tab">4. In AWS Search Bar type "EC2" and Select "EC2" Services Tab</h3>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image6.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image6.png" width="800"/></a></p>
<h3 id="5-from-resources-select-instances-running">5. From "Resources" select "Instances (Running)"</h3>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image7.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image7.png" width="800"/></a></p>
<p>Locate Public IPv4 Address of EC2 instance, either on the EC2 instance list or under Details section</p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image179.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image179.png" width="800"/></a></p>
<p>From workstation open command line interface by hitting <strong>"Start"</strong> and typing <strong>"cmd"</strong>. If you are a Mac User, launch <strong>Terminal</strong>. </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image180.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image180.png" width="800"/></a></p>
<p>Execute command </p>
<div class="highlight"><pre><span></span><code>ping &lt;Public IPv4 address of EC2&gt;
</code></pre></div>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image181.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image181.png" width="800"/></a></p>
<p>Communication is successfull now, EC2 instance has access to Internet via AWS Internet Gateway. </p>
<p>At this point we completed that part of our topology configuration. </p>
<p><a class="glightbox" data-desc-position="bottom" data-height="auto" data-width="80%" href="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image185.png"><img src="https://raw.githubusercontent.com/marcinduma/LTRCLD-2557/master/images/image185.png" width="800"/></a></p>
<p>In Next Section we will configure additional Tenant and try inter-tenant leaking. </p>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Use-case 01 - Stretched VRF" class="md-footer__link md-footer__link--prev" href="../use-case1/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Use-case 01 - Stretched VRF
            </div>
</div>
</a>
<a aria-label="Next: Use-case 03 - Inter-Tenant routing" class="md-footer__link md-footer__link--next" href="../use-case3/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Use-case 03 - Inter-Tenant routing
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
<script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
<script src="../js/print-site.js"></script>
<script>document$.subscribe(() => {const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": false, "draggable": true, "openEffect": "fade", "closeEffect": "fade", "slideEffect": "fade"});})</script></body>
</html>