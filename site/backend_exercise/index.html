
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Explore Simplicity of Public Cloud Network Configuration with Cloud Network Controller (formerly cAPIC) and Nexus Dashboard Orchestrator (NDO)">
      
      
        <meta name="author" content="Marcin Duma & Karol Okraska">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>Explore Backend App and Kubernetes Dashboard: - CiscoLive EMEA 2023 --- LTRCLD-2557</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.975780f9.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../css/print-site-enum-headings1.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings2.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings3.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings4.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings5.css">
    
      <link rel="stylesheet" href="../css/print-site-enum-headings6.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="None" data-md-color-accent="None">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#explore-backend-app-and-kubernetes-dashboard" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="CiscoLive EMEA 2023 --- LTRCLD-2557" class="md-header__button md-logo" aria-label="CiscoLive EMEA 2023 --- LTRCLD-2557" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CiscoLive EMEA 2023 --- LTRCLD-2557
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Explore Backend App and Kubernetes Dashboard:
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="CiscoLive EMEA 2023 --- LTRCLD-2557" class="md-nav__button md-logo" aria-label="CiscoLive EMEA 2023 --- LTRCLD-2557" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    CiscoLive EMEA 2023 --- LTRCLD-2557
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Lab Access
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lab Access" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Lab Access
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../LAB_access/" class="md-nav__link">
        Accessing the Lab Environment
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          INFRA Configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="INFRA Configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          INFRA Configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../infra-config/" class="md-nav__link">
        Sites onboarding
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../infra-config-msite/" class="md-nav__link">
        Multisite configuration
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Tenant configuration
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Tenant configuration" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Tenant configuration
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ndo-tenant/" class="md-nav__link">
        NDO Tenant configuration
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../aws-trust/" class="md-nav__link">
        AWS Trust
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Use-cases
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Use-cases" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Use-cases
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../use-case1/" class="md-nav__link">
        Use-case 01 - Stretched VRF
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../use-case2/" class="md-nav__link">
        Use-case 02 - Internet Gateway
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../use-case3/" class="md-nav__link">
        Use-case 03 - Inter-Tenant routing
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Appendixes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Appendixes" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Appendixes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../object-map/" class="md-nav__link">
        ACI to Public Cloud Object mapping
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../resources/" class="md-nav__link">
        Resources
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../print_page/" class="md-nav__link">
        PRINT version
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="explore-backend-app-and-kubernetes-dashboard">Explore Backend App and Kubernetes Dashboard:</h1>
<p>Your Hybrid Cloud App's backend compoents (MariaDB, MQTT DB Agent, and REST API agent) should be up and running. Now let's explore some low level details to understand the application containers and kubernetes better.</p>
<p><strong>Task 0:</strong> Tasks in this section will be executed in Kubernetes on-premise. Change kubectl context to the correct one.</p>
<p>Execute command below on linux jumphost:</p>
<div class="highlight"><pre><span></span><code>    kubectl config use-context admin@CLUS-IKS-1
</code></pre></div>
<p><strong>Task 1:</strong> Find the size of the 'Persistent Volume Claim' used for MariaDB database?</p>
<p>To check 'CAPACITY' value of PVC execute this command on linux jumphost:</p>
<div class="highlight"><pre><span></span><code>    kubectl get pvc mariadb-pv-claim
</code></pre></div>
<p><strong>Task 2:</strong> Login to the MariaDB database and explore the data tables. </p>
<ol>
<li>
<p>Find the pod name for 'MariaDB' using the kubectl command </p>
<div class="highlight"><pre><span></span><code>kubectl get pods
</code></pre></div>
<p>and locate the pod name starting with 'iot-backend-mariadb-'.</p>
</li>
<li>
<p>Login to the MariaDB container using the kubectl command</p>
<div class="highlight"><pre><span></span><code>kubectl exec -it &lt;pod name&gt; -- /bin/bash
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>(replace the <strong>&lt;pod name></strong> in command above with correct value).</p>
</div>
</li>
<li>
<p>Inside the container execute</p>
<div class="highlight"><pre><span></span><code>ss -tulpn
</code></pre></div>
<p>and check the port MariaDB is listing to for incoming connections.</p>
</li>
<li>
<p>You can also check the version of MariaDB using the shell command:</p>
<div class="highlight"><pre><span></span><code>mysql --version
</code></pre></div>
</li>
<li>
<p>Now connect to the MariaDB from the container shell and check Databases and Tables.
Use </p>
<div class="highlight"><pre><span></span><code>mysql -u root -pcisco123
</code></pre></div>
<p>command to login to MaraDB.</p>
</li>
<li>
<p>On mariaDB shell, use</p>
<div class="highlight"><pre><span></span><code>show databases;
</code></pre></div>
<p>command to list all the databases. Look for '<strong>sensor_db</strong>' in the output (this is the database where we are storing the sensor data).</p>
</li>
<li>
<p>Switch to sensor_db using the command</p>
<div class="highlight"><pre><span></span><code>use sensor_db;
</code></pre></div>
<p>and list all the tables in this database using the command</p>
<div class="highlight"><pre><span></span><code>show tables;
</code></pre></div>
<p>You should see only one table with the name <strong>'sensor_data'</strong>;</p>
</li>
<li>
<p>Try to list the data from this table using the SQL statement</p>
<div class="highlight"><pre><span></span><code>select * from sensor_data;
</code></pre></div>
</li>
<li>
<p>Now check the record count in this table using the sql statement:</p>
<div class="highlight"><pre><span></span><code>select count(*) from sensor_data;
</code></pre></div>
</li>
<li>
<p>Repeat the SQL from step 8 several times and check if the record count is increasing (each sensor would send the data after every 10 seconds). </p>
</li>
<li>
<p>Use </p>
<div class="highlight"><pre><span></span><code>exit
</code></pre></div>
<p>command at MariaDB prompt to exit the DB shell.</p>
</li>
<li>
<p>Use</p>
<div class="highlight"><pre><span></span><code>exit
</code></pre></div>
<p>command again to exit 'iot-backend-mariadb' container shell.</p>
</li>
</ol>
<p><strong>Task 3:</strong> Connect to the REST API Agent container and find the port it is listing on for incoming REST calls.</p>
<ol>
<li>
<p>Find the pod name for 'REST API Agent' using the kubectl command</p>
<div class="highlight"><pre><span></span><code>kubectl get pods
</code></pre></div>
<p>and locate the pod name starting with 'iot-backend-rest-api-agent-' (you may see more than one pod for this service, pick any one).</p>
</li>
<li>
<p>login to the REST API Agent container using the kubectl command</p>
<div class="highlight"><pre><span></span><code>kubectl exec -it &lt;pod name&gt; -- /bin/ash
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>(replace the <strong>&lt;pod name></strong> in command above with correct value).</p>
</div>
</li>
<li>
<p>Execute</p>
<div class="highlight"><pre><span></span><code>netstat -an
</code></pre></div>
<p>command on the container shell and check the output. This container listens on port '5050' for incoming REST connections and connects with MariaDB using port '3306' (Connection to DB will timeout in case there are no requests coming in).</p>
</li>
<li>
<p>Use</p>
<div class="highlight"><pre><span></span><code>exit
</code></pre></div>
<p>command to come out of the container shell.</p>
</li>
</ol>
<p><strong>Task 4:</strong> Check the logs messages from 'REST API Agent'.</p>
<ol>
<li>
<p>Find the pod name for 'REST API Agent' using the kubectl command</p>
<div class="highlight"><pre><span></span><code>kubectl get pods
</code></pre></div>
<p>and locate the pod name starting with 'iot-backend-rest-api-agent-' (you may see more than one pod for this service, pick any one).</p>
</li>
<li>
<p>Check the logs using the kubectl command</p>
<div class="highlight"><pre><span></span><code>kubectl logs &lt;pod name&gt;
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>(replace the <strong>&lt;pod name></strong> in command above with correct value).</p>
</div>
</li>
</ol>
<p><strong>Task 5:</strong> How the traffic would be distributed, if you have multiple Kubernetes Pods behind a Kubernetes NodePort Service?</p>
<ol>
<li>Right click on top of your putty window and click on "Duplicate Session" (You should have two putty windows side by side logged into same linux jumphost).</li>
<li>
<p>In the first putty window (logged into linux jumphost) execute the command</p>
<div class="highlight"><pre><span></span><code>kubectl get nodes -o wide
</code></pre></div>
<p>and note down the Kubernetes master node's external IP address.</p>
</li>
<li>
<p>Open a web browser on your machine and access the following url</p>
<div class="highlight"><pre><span></span><code>http://&lt;kubernetes node&#39;s external ip&gt;:&lt;port&gt;/temperature
</code></pre></div>
</li>
<li>
<p>In the first putty window, run</p>
<div class="highlight"><pre><span></span><code>kubectl get pods
</code></pre></div>
<p>on the linux jumphost. In the output you should see 2 pods for 'iot-backend-rest-api-agent'.</p>
</li>
<li>
<p>In the first putty window, run the command</p>
<div class="highlight"><pre><span></span><code>watch kubectl logs &lt;first pod name&gt;
</code></pre></div>
<p>(Use the first 'iot-backend-rest-api-agent' pod out of 2 pods that you saw in the output of the command executed in step#5).</p>
</li>
<li>
<p>In the Second putty window, display the logs for second 'iot-backend-rest-api-agent' pod using the command</p>
<div class="highlight"><pre><span></span><code>watch kubectl logs &lt;second pod name&gt;
</code></pre></div>
</li>
<li>
<p>Refresh or reload the web page with the url you used in step 4. </p>
</li>
<li>
<p>Repeat step 8 and check the requests hitting the kubernetes pods in the log messages.</p>
</li>
</ol>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.5a2dcb6a.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
    
    
  </body>
</html>